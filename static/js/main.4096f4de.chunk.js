(this["webpackJsonpsequence-collab"]=this["webpackJsonpsequence-collab"]||[]).push([[0],[,,,,,,,function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.__esModule=!0;var o=n(2);e.lazyCanvasRedrawerDefaultProps={width:100,height:100,style:{boxSizing:"border-box",width:"100%",height:"100%"}};var i=function(t){function n(e){var n=t.call(this,e)||this;return n.className="specify-this-in-subclass-please",n.drawStamp=0,n.timer=null,n.interval=100,n.ref=o.createRef(),n.handleResize=n.handleResize.bind(n),n}return r(n,t),n.prototype.draw=function(t){},n.prototype.redraw=function(t){var e=this;if(void 0===t&&(t=!1),t||!this.drawStamp||Date.now()-this.drawStamp>this.interval){this.drawStamp=Date.now(),clearTimeout(this.timer),this.timer=null;var n=this.ref.current;n.style.width="100%",n.style.height="100%",n.width=n.clientWidth,n.height=n.clientHeight;var r=n.getContext("2d");r.clearRect(0,0,r.canvas.width,r.canvas.height),this.draw(r)}else this.timer||(this.timer=setTimeout((function(){return e.redraw()}),Date.now()-this.drawStamp))},n.prototype.handleResize=function(){this.redraw()},n.prototype.componentDidMount=function(){window.addEventListener("resize",this.handleResize),this.redraw()},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleResize)},n.prototype.componentDidUpdate=function(){this.redraw(!0)},n.prototype.render=function(){return o.createElement("canvas",{style:this.props.style,height:this.props.height,width:this.props.width,ref:this.ref,className:this.className})},n.defaultProps=e.lazyCanvasRedrawerDefaultProps,n}(o.Component);e.LazyCanvasRedrawer=i},function(t,e,n){"use strict";e.__esModule=!0,e.propToAbs=function(t,e,n){void 0===n&&(n={});var r=n.padding||0;return{x:r+e.x*(t.canvas.width-2*r),y:r+e.y*(t.canvas.height-2*r)}},e.absToProp=function(t,e,n){void 0===n&&(n={});var r=n.padding||0;return{x:e.x/(t.canvas.width-2*r)-r,y:e.y/(t.canvas.height-2*r)-r}}},,function(t,e,n){"use strict";e.__esModule=!0,e.mousePointInElement=function(t,e){var n=t.getBoundingClientRect();return{x:Math.floor(e.clientX-n.left),y:Math.floor(e.clientY-n.top)}}},,function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__read||function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};e.__esModule=!0;var s=n(7),u=n(41),c=n(42),l=n(43),h=n(3),f=n(44),p=n(8),d=n(45),y=[7,5,3,2],v=function(t){function e(e){var n=t.call(this,e)||this;return n.mouseManager=new f.CanvasMouseManager,n.notes=[],n.highlights=new Set,n.setGridTree(l.tree44),n}return r(e,t),e.prototype.setNotes=function(t){this.notes=t,this.redraw()},e.prototype.setGridTree=function(t){this.gridTree=t,this.gridTreePoints=l.getRhythmPoints(t)},e.prototype.draw=function(t){var e=this;u.drawLineP(t,{padding:10},{x:0,y:.5},{x:1,y:.5},"gray"),this.highlights.forEach((function(e){c.drawCircle(t,h.rectCenter(e.rect),15,"gray",!1,[3,3])})),this.notes.forEach((function(n){c.drawCircleP(t,{padding:10,fixedRadius:!0},{x:n,y:.5},13,e.props.style.color,!0,.5)})),this.gridTreePoints.forEach((function(e){c.drawCircleP(t,{padding:10,fixedRadius:!0},{x:e.position,y:.5},y[e.depth],"gray",!0)}))},e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.mouseManager.initialize(this.ref.current),this.addAreas(),this.setupKeyEvents()},e.prototype.setupKeyEvents=function(){var t=this;d.onTransition((function(e,n){switch(e){case"Shift":t.updateHighlights()}}))},e.prototype.addAreas=function(){var t=this;this.gridTreePoints.forEach((function(e,n){var r=e.position,o={x:r,y:.5},i=p.propToAbs(t.ref.current.getContext("2d"),o,{padding:10}),a=t.mouseManager.createArea(i.x-15,i.y-15,i.x+15,i.y+15,n);a.onMouseEnter((function(){return t.updateHighlights()})),a.onMouseLeave((function(){return t.updateHighlights()})),a.onMouseDown((function(){return t.toggleNote(r)})),e.area=a}))},e.prototype.getHoverPoint=function(){var t=this.mouseManager.getTopHover();return this.gridTreePoints.find((function(e){return e.area===t}))},e.prototype.updateHighlights=function(){var t=this;this.highlights.clear();var e=this.getHoverPoint();e&&(d.keysPressed.Shift?this.multiplyPoint(e).forEach((function(e){return t.addHighlight(e.area)})):this.highlights.add(e.area)),this.redraw(!0)},e.prototype.multiplyPoint=function(t){var e=this,n=16*t.position%4;return[0,1,2,3].map((function(t){return e.gridTreePoints[4*t+n]}))},e.prototype.toggleNote=function(t){var e=this;-1===this.notes.indexOf(t)?this.highlights.forEach((function(t){return e.notes.push(.0625*t.id)})):this.notes=this.notes.filter((function(t){return!a(e.highlights).map((function(t){return.0625*t.id})).includes(t)})),this.props.onChange(this.notes),this.redraw()},e.prototype.addHighlight=function(t){this.highlights.add(t),this.redraw(!0)},e.prototype.removeHighlight=function(t){this.highlights.delete(t),this.redraw(!0)},e.prototype.removeAllHighlights=function(){this.highlights.clear(),this.redraw(!0)},e.defaultProps={style:o(o({},s.lazyCanvasRedrawerDefaultProps.style),{color:"red"}),width:750,height:50,onChange:function(){}},e}(s.LazyCanvasRedrawer);e.SingleNoteLane=v},,function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}e.__esModule=!0;var o=n(25);e.PianoKeyboard=o.PianoKeyboard;var i=n(33);e.GuitarChordDiagram=i.GuitarChordDiagram,r(n(38)),r(n(12)),r(n(46))},,function(t,e,n){t.exports=n.p+"static/media/cursor_PNG99.be56600f.png"},,,function(t,e,n){t.exports=n(50)},,,,,function(t,e,n){},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__read||function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};e.__esModule=!0;var s=n(2),u=n(28),c=n(7),l=n(3),h=n(10),f=o({onNoteDown:function(){},onNoteUp:function(){},keyRange:{min:36,max:72}},c.lazyCanvasRedrawerDefaultProps),p=function(t){function e(e){var n=t.call(this,e)||this;return n.keys=[],n.state={depressedKeys:[]},n}return r(e,t),e.prototype.draw=function(t){this.keys=u.drawKeyboardInCanvas(t,this.props,Array.from(this.state.depressedKeys))},e.prototype.handleClick=function(t){var e=this,n=this.getKeyUnderPoint(h.mousePointInElement(this.ref.current,t));if(n){var r=this.state.depressedKeys;r.includes(n.pitch)?this.setState({depressedKeys:r.filter((function(t){return t!==n.pitch}))},(function(){e.props.onNoteUp(n.pitch)})):this.setState({depressedKeys:a(r,[n.pitch])},(function(){e.props.onNoteDown(n.pitch,127)}))}},e.prototype.getKeyUnderPoint=function(t){var e=this.keys.filter((function(t){return"Black"===t.type})).find((function(e){return l.pointInRect(t,e.rect)}));return e||(this.keys.filter((function(t){return"White"===t.type})).find((function(e){return l.pointInRect(t,e.rect)}))||null)},e.prototype.render=function(){var t=this;return s.createElement("canvas",{height:"200px",ref:this.ref,className:"keyboard",style:{width:"100%",height:"100%"},onClick:function(e){return t.handleClick(e)}})},e.defaultProps=f,e}(c.LazyCanvasRedrawer);e.PianoKeyboard=p},,,function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};e.__esModule=!0;e.drawKeyboardInCanvas=function(t,e,n){var r=function(t,e,n){for(var r=[],o=t.keyRange.min;o<=t.keyRange.max;o++)[0,2,4,5,7,9,11].includes(o%12)&&r.push(o);var i=e/r.length;return r.map((function(t,e){return{type:"White",rect:{left:e*i,top:0,right:(e+1)*i,bottom:n},pitch:t}}))}(e,t.canvas.width,t.canvas.height),i=function(t){var e=7*(t[0].rect.right-t[0].rect.left)/12;return t.slice(0,-1).filter((function(t){return[0,2,5,7,9].includes(t.pitch%12)})).map((function(t){var n=t.rect.right-t.rect.left,r=t.rect.bottom-t.rect.top,o=[0,2,4,5,7,9].indexOf(t.pitch%12),i=t.rect.right+n*[-.35,-.25,-.25,-.35,-.3,-.25][o];return{type:"Black",rect:{left:i,top:t.rect.top,right:i+e,bottom:t.rect.top+.6*r},pitch:t.pitch+1}}))}(r);return o(r,i).forEach((function(e){return function(t,e,n){t.fillStyle="White"===e.type?n?"lightblue":"white":n?"blue":"black",t.strokeStyle="black",t.fillRect(e.rect.left,e.rect.top,e.rect.right-e.rect.left,e.rect.bottom-e.rect.top),t.strokeRect(e.rect.left,e.rect.top,e.rect.right-e.rect.left,e.rect.bottom-e.rect.top)}(t,e,n.includes(e.pitch))})),o(r,i)}},,,,,function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};e.__esModule=!0;var i=n(34),a=n(7),s=n(3),u=o(o({},a.lazyCanvasRedrawerDefaultProps),{baseNote:41,numFrets:5,fingeredNotes:[48,52,55,59,60].map((function(t){return{pitch:t,isTonic:0===s.pitchClass(t)}})),color:"black"}),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="guitar-chord-diagram",e}return r(e,t),e.prototype.draw=function(t){i.drawDiagramInCanvas(t,this.props)},e.defaultProps=u,e}(a.LazyCanvasRedrawer);e.GuitarChordDiagram=c},function(t,e,n){"use strict";e.__esModule=!0;var r=n(11),o=n(37);function i(t,e){for(var n=[],r=t/(e+1),o=0;o<e+1;o++)n.push(r*(o+.5));return n}function a(t){var e=t/6;return[0,1,2,3,4,5].map((function(t){return(t+.5)*e}))}e.drawDiagramInCanvas=function(t,e){return function(t,e,n){var o=a(t.canvas.width),s=i(t.canvas.height,e);t.strokeStyle=n,t.lineWidth=3,o.forEach((function(e){t.moveTo(e,s[0]),t.lineTo(e,r.last(s))})),s.forEach((function(e){t.moveTo(o[0],e),t.lineTo(r.last(o),e)})),t.stroke()}(t,e.numFrets,e.color),function(t,e){var n=a(t.canvas.width),r=i(t.canvas.height,e.numFrets),s=r[1]-r[0],u=n[1]-n[0],c=.25*Math.min(u,s);return e.fingeredNotes.map((function(t){var n=o.getStringAndFret(t.pitch,e.baseNote);return n.alternates.length>0?(l(n.string,n.fret,"Diamond"),n.alternates.forEach((function(t){return l(t.string,t.fret,"Diamond")}))):l(n.string,n.fret,t.isTonic?"TonicCircle":"NonTonicCircle"),null})).filter(Boolean);function l(o,i,a){var u=n[o],l=r[i]+s/2;switch(t.lineWidth=3,t.beginPath(),a){case"TonicCircle":case"NonTonicCircle":t.arc(u,l,c,0,2*Math.PI),t.fillStyle="TonicCircle"===a?"white":e.color,t.fill();break;case"Diamond":t.moveTo(u-c,l),t.lineTo(u,l+c),t.lineTo(u+c,l),t.lineTo(u,l-c),t.closePath(),t.fillStyle="white",t.fill(),t.fillStyle=e.color,t.globalAlpha=.5,t.fill(),t.globalAlpha=1}t.stroke()}}(t,e)}},,,function(t,e,n){"use strict";e.__esModule=!0,e.getStringAndFret=function(t,e){var n=[0,5,10,15,19,24].map((function(t){return e+t})),r=n.findIndex((function(e,r){return t>=e&&(!n[r+1]||t<n[r+1])})),o=t-n[r];return{string:r,fret:o,alternates:4===r&&0===o?[{string:3,fret:4}]:[]}}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(39);e.ButtonGrid=r.ButtonGrid},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};e.__esModule=!0;var o=n(2),i=n(11),a=n(40);function s(t){function e(e,n,r){t.onButtonDown(n,r)}return o.createElement("table",{className:"button-grid",style:r({},t.style)},o.createElement("tbody",null,i.times(t.numRows,(function(n){return o.createElement("tr",{key:n},i.times(t.numColumns,(function(r){return a.ButtonGridButton(r,t,n,e)})))}))))}e.ButtonGrid=s,s.defaultProps={numRows:4,numColumns:4,onButtonDown:function(t,e){},style:{color:"white"},clickColor:"pink"}},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};e.__esModule=!0;var o=n(2);e.ButtonGridButton=function(t,e,n,i){var a=r(o.useState(!1),2),s=a[0],u=a[1];return o.createElement("td",{className:"button-grid-button",key:t,style:{backgroundColor:s?e.clickColor:e.style.color,borderRadius:"5px"},onMouseDown:function(e){u(!0),i(e,n,t)},onMouseUp:function(){return setTimeout((function(){return u(!1)}),100)}})}},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t};e.__esModule=!0;var i=n(8);function a(t,e,n,r,o,i){void 0===r&&(r="black"),void 0===o&&(o=1),void 0===i&&(i=[]),t.strokeStyle=r,t.lineWidth=o,t.setLineDash(i),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.stroke()}e.drawLine=a,e.drawLineP=function(t,e,n,r){for(var s=[],u=4;u<arguments.length;u++)s[u-4]=arguments[u];a.apply(void 0,o([t,i.propToAbs(t,n,e||void 0),i.propToAbs(t,r,e||void 0)],s))}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(8);function o(t,e,n,r,o,i,a){void 0===r&&(r="black"),void 0===o&&(o=!1),void 0===i&&(i=[]),void 0===a&&(a=1),t.save(),t.globalAlpha=a,t.beginPath(),t.arc(e.x,e.y,n,0,2*Math.PI),o?(t.fillStyle=r,t.fill()):(t.setLineDash(i),t.strokeStyle=r,t.stroke()),t.restore()}e.drawCircle=o,e.drawCircleP=function(t,e,n,i,a,s,u){void 0===a&&(a="black"),void 0===s&&(s=!1),void 0===u&&(u=1);var c=Math.min(t.canvas.width,t.canvas.height);o(t,r.propToAbs(t,n,e||void 0),e.fixedRadius?i:i*c,a,s,[],u)}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__read||function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};e.__esModule=!0,e.tree44={nodes:i(Array(4)).map((function(){return{units:1,subtree:{nodes:i(Array(2)).map((function(){return{units:1,subtree:{nodes:[1,1]}}}))}}}))},e.getRhythmPoints=function t(e,n,o,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=1);var s=o,u=a/function(t){return t.nodes.reduce((function(t,e){return t+("number"===typeof e?e:e.units)}),0)}(e),c=[];return e.nodes.forEach((function(e,o){if("number"===typeof e)c.push({position:s,depth:0===o?n:n+1}),s+=u*e;else{var a=t(e.subtree,n+1,s,u*e.units),l=0===o?r(r({},a[0]),{depth:n}):a[0];c.push.apply(c,i([l],a.slice(1))),s+=u*e.units}})),c}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.__esModule=!0;var o=n(3),i=n(1),a=n(10),s=function(){function t(t,e){this.emitter=new i.EventEmitter,this.rect=t,this.id=e}return t.prototype.emitMouseDown=function(t){this.emitter.emit("mousedown",t)},t.prototype.onMouseDown=function(t){this.emitter.on("mousedown",t)},t.prototype.emitMouseEnter=function(){this.emitter.emit("mouseenter")},t.prototype.onMouseEnter=function(t){this.emitter.on("mouseenter",t)},t.prototype.emitMouseLeave=function(){this.emitter.emit("mouseleave")},t.prototype.onMouseLeave=function(t){this.emitter.on("mouseleave",t)},t}();e.MouseArea=s;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastDragStamp=0,e.areas=[],e.hover=new Set,e}return r(e,t),e.prototype.initialize=function(t){var e=this;this.canvas=t,t.onmousedown=function(t){return e.handleMouseDown(t)},t.onmousemove=function(t){return e.handleMove(t)},t.draggable=!0,t.ondragstart=function(t){return e.handleDragStart(t)},t.ondrag=function(t){return e.handleDrag(t)},t.onmouseleave=function(t){return e.handleMouseLeave(t)},this.dragImage=document.createElement("img"),this.dragImage.setAttribute("style","width:1px;height:1px;border:none;display:block"),this.dragImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},e.prototype.getTopHover=function(){return this.hover.values().next().value},e.prototype.createArea=function(t,e,n,r,o){var i=new s({left:t,top:e,right:n,bottom:r},o);return this.areas.push(i),i},e.prototype.getAreaUnderPoint=function(t){return this.areas.find((function(e){return o.pointInRect(t,e.rect)}))},e.prototype.getAllAreasUnderPoint=function(t){return new Set(this.areas.filter((function(e){return o.pointInRect(t,e.rect)})))},e.prototype.handleMouseDown=function(t){var e=a.mousePointInElement(this.canvas,t),n=this.getAreaUnderPoint(e);n&&n.emitMouseDown(o.subtractPoints(e,{x:n.rect.left,y:n.rect.top})),this.emit("mousedown",t)},e.prototype.handleMove=function(t){var e=this.getAllAreasUnderPoint(a.mousePointInElement(this.canvas,t)),n=this.hover;this.hover=e,e.forEach((function(t){n.has(t)||t.emitMouseEnter()})),n.forEach((function(t){e.has(t)||t.emitMouseLeave()})),this.emit("mousemove",t)},e.prototype.handleMouseLeave=function(t){this.hover.forEach((function(t){return t.emitMouseLeave()})),this.hover.clear()},e.prototype.handleDragStart=function(t){this.dragStart={x:t.clientX,y:t.clientY},t.dataTransfer.setDragImage(this.dragImage,1e3,1e3)},e.prototype.handleMouseBoxDragEnd=function(t){},e.prototype.handleDrag=function(t){if(Date.now()-this.lastDragStamp>100){o.subtractPoints({x:t.clientX,y:t.clientY},this.dragStart);this.lastDragStamp=Date.now()}},e}(i.EventEmitter);e.CanvasMouseManager=u},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1);e.keysPressed={};var o=new r.EventEmitter;function i(t,e){o.emit("transition",t,e)}e.onTransition=function(t){o.on("transition",t)},window.addEventListener("keydown",(function(t){e.keysPressed[t.key]=!0,i(t.key,"Down")})),window.addEventListener("keyup",(function(t){e.keysPressed[t.key]=!1,i(t.key,"Up")}))},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};e.__esModule=!0;var i=n(2),a=n(12),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lanes=[0,1,2,3].map((function(t){return i.createRef()})),e}return r(e,t),e.prototype.setNotes=function(t,e){this.lanes[t].current.setNotes(e)},e.prototype.render=function(){var t=this;return i.createElement("div",null,["blue","green","orange","red"].map((function(e,n){return i.createElement(a.SingleNoteLane,{key:n,ref:t.lanes[n],style:o(o({},a.SingleNoteLane.defaultProps.style),{color:e}),onChange:function(e){return t.props.onChange&&t.props.onChange(n,e)}})})))},e}(i.Component);e.MultiNoteLanes=s},,,,function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),i=n(13),a=n.n(i),s=n(6),u=n(4),c=n(5),l=n(17),h=n(18),f=(n(24),n(14));function p(t,e){var n=t.createOscillator(),r=t.createOscillator(),o=t.createGain(),i=t.createGain();n.type="triangle",r.type="sine",o.gain.setValueAtTime(1,e),o.gain.exponentialRampToValueAtTime(.001,e+.5),i.gain.setValueAtTime(1,e),i.gain.exponentialRampToValueAtTime(.001,e+.5),n.frequency.setValueAtTime(120,e),n.frequency.exponentialRampToValueAtTime(.001,e+.5),r.frequency.setValueAtTime(50,e),r.frequency.exponentialRampToValueAtTime(.001,e+.5),n.connect(o),r.connect(i),i.connect(t.destination),o.connect(t.destination),o.connect(t.destination),i.connect(t.destination),n.start(e),r.start(e),n.stop(e+.5),r.stop(e+.5)}function d(t,e){var n=t.createOscillator(),r=t.createGain(),o=t.createGain();o.gain.setValueAtTime(1,e),o.gain.exponentialRampToValueAtTime(.01,e+.2),n.type="triangle",n.frequency.value=100,r.gain.value=0,r.gain.setValueAtTime(0,e),r.gain.exponentialRampToValueAtTime(.01,e+.1),n.connect(r),r.connect(t.destination),n.start(e),n.stop(e+.2);var i=t.createBufferSource(),a=t.createBuffer(1,4096,t.sampleRate),s=a.getChannelData(0),u=t.createBiquadFilter();u.type="highpass",u.frequency.setValueAtTime(100,e),u.frequency.linearRampToValueAtTime(1e3,e+.2);for(var c=0;c<4096;c++)s[c]=Math.random();i.buffer=a,i.loop=!0,i.connect(u),u.connect(o),o.connect(t.destination),i.start(e),i.stop(e+.2)}function y(t,e){var n=t.createGain(),r=t.createBiquadFilter();r.type="bandpass",r.frequency.value=1e4;var o=t.createBiquadFilter();o.type="highpass",o.frequency.value=7e3,[2,3,4.16,5.43,6.79,8.21].forEach((function(n){var o=t.createOscillator();o.type="square",o.frequency.value=40*n,o.connect(r),o.start(e),o.stop(e+.05)})),n.gain.setValueAtTime(1,e),n.gain.exponentialRampToValueAtTime(.01,e+.05),r.connect(o),o.connect(n),n.connect(t.destination)}var v=n(1);var m=function(){function t(){Object(u.a)(this,t),this.ac=void 0,this.timer=void 0,this.loop=[],this.prevHorizon=0,this.emitter=new v.EventEmitter,this.loopLength=2}return Object(c.a)(t,[{key:"setAudioContext",value:function(t){this.ac=t}},{key:"setLoop",value:function(t){this.loop=t}},{key:"start",value:function(){var t=this;this.timer||(this.timer=setInterval((function(){return t.iterate()}),25))}},{key:"emitSchedule",value:function(t){this.emitter.emit("schedule",t)}},{key:"onSchedule",value:function(t){this.emitter.on("schedule",t)}},{key:"iterate",value:function(){var t=function(t,e,n,r,o){var i={min:Math.max(e,r),max:e+n},a=i.min/o,s=a%1-a,u={min:a+s,max:i.max/o+s};return{schedule:t.map((function(t){var e=function(t,e){return(t-e.min+1)%1>e.max-e.min?null:t<e.min?t+1:t}(t.loopTime,u);return e?{data:t.data,audioContextTime:(e-s)*o}:null})).filter(Boolean),horizon:i.max}}(this.loop,this.ac.currentTime,.1,this.prevHorizon,this.loopLength),e=t.schedule,n=t.horizon;this.prevHorizon=n,e.length>0&&this.emitSchedule(e)}}]),t}(),g=n(15),w=n(16),_=n.n(w),b="ws://".concat("167.172.3.7"),A=function(t){Object(h.a)(n,t);var e=Object(l.a)(n);function n(t){var r;return Object(u.a)(this,n),(r=e.call(this,t)).scheduler=new m,r.ac=void 0,r.user="user"+Math.floor(1e4*Math.random()),r.multiLane=o.a.createRef(),r.subLoops=[[],[],[],[]],r.client=new g.MessageClient(b),r.mousePosition={x:-10,y:-10},r.state={otherMouse:{x:-10,y:-10}},r.scheduler.onSchedule((function(t){return t.forEach((function(t){(0,[y,y,d,p][t.data])(r.ac,t.audioContextTime)}))})),r.client.onMessage((function(t){return r.handleServerMessage(t)})),r.client.onConnected((function(){setInterval((function(){return r.reportMousePosition()}),100)})),r}return Object(c.a)(n,[{key:"startAudio",value:function(){this.ac?this.ac.resume():(this.ac=new AudioContext,this.scheduler.setAudioContext(this.ac),this.scheduler.start())}},{key:"stopAudio",value:function(){this.ac&&this.ac.suspend()}},{key:"handleNoteChange",value:function(t,e){var n,r=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(o){var i=M(this.subLoops[t].map((function(t){return t.loopTime})),e);i.add.forEach((function(e){return r.client.send({user:r.user,type:"NoteChange",content:{sequence:0,action:"Add",instrument:t,loopTime:e}})})),i.delete.forEach((function(e){return r.client.send({user:r.user,type:"NoteChange",content:{sequence:0,action:"Delete",instrument:t,loopTime:e}})}))}this.subLoops[t]=e.map((function(e){return{data:t,loopTime:e}})),this.scheduler.setLoop((n=[]).concat.apply(n,Object(s.a)(this.subLoops)))}},{key:"handleServerMessage",value:function(t){var e,n;if(t.user!==this.user)switch(t.type){case"MousePosition":this.setState({otherMouse:t.content});break;case"NoteChange":var r=t.content,o=function(t,e){var n,r=t.slice();return(n=r).push.apply(n,Object(s.a)(e.add)),r=r.filter((function(t){return!e.delete.includes(t)}))}(this.subLoops[r.instrument].map((function(t){return t.loopTime})),{add:"Add"===r.action?[r.loopTime]:[],delete:"Delete"===r.action?[r.loopTime]:[]});null===(e=this.multiLane.current)||void 0===e||e.setNotes(r.instrument,o),this.subLoops[r.instrument]=o.map((function(t){return{data:r.instrument,loopTime:t}})),this.scheduler.setLoop((n=[]).concat.apply(n,Object(s.a)(this.subLoops)))}}},{key:"reportMousePosition",value:function(){this.client.send({user:this.user,type:"MousePosition",content:this.mousePosition})}},{key:"handleMouseMove",value:function(t){this.mousePosition={x:t.clientX,y:t.clientY}}},{key:"render",value:function(){var t=this;return o.a.createElement("div",{className:"App",onMouseMove:function(e){return t.handleMouseMove(e)}},">",o.a.createElement("header",null,"sequence collab"),o.a.createElement("div",{id:"main"},o.a.createElement(f.MultiNoteLanes,{ref:this.multiLane,onChange:function(e,n){t.handleNoteChange(e,n)}}),o.a.createElement("button",{onClick:function(){return t.startAudio()}},"play"),o.a.createElement("button",{onClick:function(){return t.stopAudio()}},"pause")),o.a.createElement("img",{src:_.a,id:"otherguy",alt:"",style:{opacity:.3,position:"fixed",left:this.state.otherMouse.x,top:this.state.otherMouse.y,height:20,width:20}}))}}]),n}(o.a.Component);function M(t,e){return{add:e.filter((function(e){return!t.includes(e)})),delete:t.filter((function(t){return!e.includes(t)}))}}a.a.render(o.a.createElement(A,null),document.getElementById("root"))}],[[19,1,2]]]);
//# sourceMappingURL=main.4096f4de.chunk.js.map