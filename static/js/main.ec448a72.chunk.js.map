{"version":3,"sources":["../../../../src/generic-components/LazyCanvasRedrawer/LazyCanvasRedrawer.tsx","../../../../src/graphics/canvas-drawing/convert.ts","../../../src/utils/clickedPointInCanvas.tsx","../../../../src/components/SingleNoteLane/SingleNoteLane.tsx","../../src/index.ts","../../../../src/components/PianoKeyboard/PianoKeyboard.tsx","../../../../src/components/PianoKeyboard/drawKeyboardInCanvas.ts","../../../../src/components/GuitarChordDiagram/GuitarChordDiagram.tsx","../../../../src/components/GuitarChordDiagram/drawDiagramInCanvas.ts","../../../../src/components/GuitarChordDiagram/getStringAndFret.ts","../../../../src/components/ButtonGrid/index.ts","../../../../src/components/ButtonGrid/ButtonGrid.tsx","../../../../src/components/ButtonGrid/ButtonGridButton.tsx","../../../../src/graphics/canvas-drawing/drawLine.ts","../../../../src/graphics/canvas-drawing/drawCircle.ts","../../../../src/components/SingleNoteLane/trees.ts","../../../../src/ui/CanvasMouseManager/CanvasMouseManager.ts","../../../src/ui/key-monitor.ts","../../../../src/components/MultiNoteLanes/MultiNoteLanes.tsx","drumSynth.ts","Scheduler/Scheduler.ts","Scheduler/getNewScheduledNotes.ts","Scheduler/windowPosition.ts","App.tsx","index.tsx"],"names":["y","i","ctx","_","e","exports","callback","window","addEventListener","emitTransition","ev","key","kick","audioContext","start","osc","createOscillator","osc2","gainOsc","createGain","gainOsc2","type","gain","setValueAtTime","exponentialRampToValueAtTime","frequency","connect","destination","stop","snare","osc3","gainOsc3","filterGain","value","node","createBufferSource","buffer","createBuffer","sampleRate","data","getChannelData","filter","createBiquadFilter","linearRampToValueAtTime","Math","random","loop","hihat","gainOsc4","bandpass","highpass","forEach","ratio","osc4","Scheduler","ac","timer","prevHorizon","emitter","EventEmitter","loopLength","this","setInterval","iterate","notes","emit","on","console","log","currentTime","acTime","lookAhead","win","min","max","rawPropWindow","translation","propWindow","schedule","map","note","pos","loopTime","windowPosition","audioContextTime","Boolean","horizon","getNewScheduledNotes","length","emitSchedule","App","props","scheduler","subLoops","onSchedule","fn","resume","AudioContext","setAudioContext","suspend","instr","setLoop","concat","className","id","onChange","handleNoteChange","onClick","startAudio","stopAudio","React","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.ec448a72.chunk.js","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar React = require(\"react\");\nexports.lazyCanvasRedrawerDefaultProps = {\n    width: 100,\n    height: 100,\n    style: {\n        boxSizing: 'border-box',\n        width: '100%',\n        height: '100%'\n    }\n};\nvar LazyCanvasRedrawer = (function (_super) {\n    __extends(LazyCanvasRedrawer, _super);\n    function LazyCanvasRedrawer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.className = \"specify-this-in-subclass-please\";\n        _this.drawStamp = 0;\n        _this.timer = null;\n        _this.interval = 100;\n        _this.ref = React.createRef();\n        _this.handleResize = _this.handleResize.bind(_this);\n        return _this;\n    }\n    LazyCanvasRedrawer.prototype.draw = function (ctx) {\n    };\n    LazyCanvasRedrawer.prototype.redraw = function (force) {\n        var _this = this;\n        if (force === void 0) { force = false; }\n        if (force ||\n            !this.drawStamp ||\n            Date.now() - this.drawStamp > this.interval) {\n            this.drawStamp = Date.now();\n            clearTimeout(this.timer);\n            this.timer = null;\n            var canvas = this.ref.current;\n            canvas.style.width = \"100%\";\n            canvas.style.height = \"100%\";\n            canvas.width = canvas.clientWidth;\n            canvas.height = canvas.clientHeight;\n            var ctx = canvas.getContext(\"2d\");\n            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n            this.draw(ctx);\n        }\n        else {\n            if (!this.timer) {\n                this.timer = setTimeout(function () { return _this.redraw(); }, Date.now() - this.drawStamp);\n            }\n        }\n    };\n    LazyCanvasRedrawer.prototype.handleResize = function () {\n        this.redraw();\n    };\n    LazyCanvasRedrawer.prototype.componentDidMount = function () {\n        window.addEventListener(\"resize\", this.handleResize);\n        this.redraw();\n    };\n    LazyCanvasRedrawer.prototype.componentWillUnmount = function () {\n        window.removeEventListener(\"resize\", this.handleResize);\n    };\n    LazyCanvasRedrawer.prototype.componentDidUpdate = function () {\n        this.redraw(true);\n    };\n    LazyCanvasRedrawer.prototype.render = function () {\n        return (React.createElement(\"canvas\", { style: this.props.style, height: this.props.height, width: this.props.width, ref: this.ref, className: this.className }));\n    };\n    LazyCanvasRedrawer.defaultProps = exports.lazyCanvasRedrawerDefaultProps;\n    return LazyCanvasRedrawer;\n}(React.Component));\nexports.LazyCanvasRedrawer = LazyCanvasRedrawer;\n//# sourceMappingURL=LazyCanvasRedrawer.js.map","\"use strict\";\nexports.__esModule = true;\nfunction propToAbs(ctx, point, options) {\n    if (options === void 0) { options = {}; }\n    var padding = options.padding || 0;\n    return {\n        x: padding + point.x * (ctx.canvas.width - padding * 2),\n        y: padding + point.y * (ctx.canvas.height - padding * 2)\n    };\n}\nexports.propToAbs = propToAbs;\nfunction absToProp(ctx, point, options) {\n    if (options === void 0) { options = {}; }\n    var padding = options.padding || 0;\n    return {\n        x: point.x / (ctx.canvas.width - padding * 2) - padding,\n        y: point.y / (ctx.canvas.height - padding * 2) - padding\n    };\n}\nexports.absToProp = absToProp;\n//# sourceMappingURL=convert.js.map","\"use strict\";\nexports.__esModule = true;\nfunction mousePointInElement(canvas, e) {\n    var rect = canvas.getBoundingClientRect();\n    var clickedPoint = { x: Math.floor(e.clientX - rect.left), y: Math.floor(e.clientY - rect.top) };\n    return clickedPoint;\n}\nexports.mousePointInElement = mousePointInElement;\n//# sourceMappingURL=clickedPointInCanvas.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nexports.__esModule = true;\nvar LazyCanvasRedrawer_1 = require(\"../../generic-components/LazyCanvasRedrawer/LazyCanvasRedrawer\");\nvar drawLine_1 = require(\"../../graphics/canvas-drawing/drawLine\");\nvar drawCircle_1 = require(\"../../graphics/canvas-drawing/drawCircle\");\nvar trees_1 = require(\"./trees\");\nvar base_1 = require(\"@musicenviro/base\");\nvar CanvasMouseManager_1 = require(\"../../ui/CanvasMouseManager/CanvasMouseManager\");\nvar convert_1 = require(\"../../graphics/canvas-drawing/convert\");\nvar key_monitor_1 = require(\"../../ui/key-monitor\");\nvar radii = [7, 5, 3, 2];\nvar tickSizes = [0.2, 0.15, 0.075, 0.05];\nvar hoverAreaRadius = 15;\nvar SingleNoteLane = (function (_super) {\n    __extends(SingleNoteLane, _super);\n    function SingleNoteLane(props) {\n        var _this = _super.call(this, props) || this;\n        _this.mouseManager = new CanvasMouseManager_1.CanvasMouseManager();\n        _this.notes = [];\n        _this.highlights = new Set();\n        _this.setGridTree(trees_1.tree44);\n        return _this;\n    }\n    SingleNoteLane.prototype.setGridTree = function (tree) {\n        this.gridTree = tree;\n        this.gridTreePoints = trees_1.getRhythmPoints(tree);\n    };\n    SingleNoteLane.prototype.draw = function (ctx) {\n        var _this = this;\n        drawLine_1.drawLineP(ctx, { padding: 10 }, { x: 0, y: 0.5 }, { x: 1, y: 0.5 }, 'gray');\n        this.highlights.forEach(function (area) {\n            drawCircle_1.drawCircle(ctx, base_1.rectCenter(area.rect), hoverAreaRadius, 'gray', false, [3, 3]);\n        });\n        this.notes.forEach(function (pos) {\n            drawCircle_1.drawCircleP(ctx, { padding: 10, fixedRadius: true }, { x: pos, y: 0.5 }, hoverAreaRadius - 2, _this.props.style.color, true, 0.5);\n        });\n        this.gridTreePoints.forEach(function (point) {\n            drawCircle_1.drawCircleP(ctx, { padding: 10, fixedRadius: true }, { x: point.position, y: 0.5 }, radii[point.depth], 'gray', true);\n        });\n    };\n    SingleNoteLane.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.mouseManager.initialize(this.ref.current);\n        this.addAreas();\n        this.setupKeyEvents();\n    };\n    SingleNoteLane.prototype.setupKeyEvents = function () {\n        var _this = this;\n        key_monitor_1.onTransition(function (key, newState) {\n            switch (key) {\n                case 'Shift':\n                    _this.updateHighlights();\n                    break;\n            }\n        });\n    };\n    SingleNoteLane.prototype.addAreas = function () {\n        var _this = this;\n        this.gridTreePoints.forEach(function (treePoint, i) {\n            var pos = treePoint.position;\n            var prop = { x: pos, y: 0.5 };\n            var center = convert_1.propToAbs(_this.ref.current.getContext('2d'), prop, {\n                padding: 10\n            });\n            var area = _this.mouseManager.createArea(center.x - hoverAreaRadius, center.y - hoverAreaRadius, center.x + hoverAreaRadius, center.y + hoverAreaRadius, i);\n            area.onMouseEnter(function () { return _this.updateHighlights(); });\n            area.onMouseLeave(function () { return _this.updateHighlights(); });\n            area.onMouseDown(function () { return _this.toggleNote(pos); });\n            treePoint.area = area;\n        });\n    };\n    SingleNoteLane.prototype.getHoverPoint = function () {\n        var hover = this.mouseManager.getTopHover();\n        return this.gridTreePoints.find(function (point) { return point.area === hover; });\n    };\n    SingleNoteLane.prototype.updateHighlights = function () {\n        var _this = this;\n        this.highlights.clear();\n        var hoverPoint = this.getHoverPoint();\n        if (hoverPoint) {\n            if (key_monitor_1.keysPressed.Shift) {\n                this.multiplyPoint(hoverPoint).forEach(function (point) { return _this.addHighlight(point.area); });\n            }\n            else {\n                this.highlights.add(hoverPoint.area);\n            }\n        }\n        this.redraw(true);\n    };\n    SingleNoteLane.prototype.multiplyPoint = function (point) {\n        var _this = this;\n        var division = (point.position * 16) % 4;\n        return [0, 1, 2, 3].map(function (beat) { return _this.gridTreePoints[beat * 4 + division]; });\n    };\n    SingleNoteLane.prototype.toggleNote = function (pos) {\n        var _this = this;\n        var index = this.notes.indexOf(pos);\n        if (index === -1) {\n            this.highlights.forEach(function (area) { return _this.notes.push(area.id * 0.0625); });\n        }\n        else {\n            this.notes = this.notes.filter(function (pos) { return !__spread(_this.highlights).map(function (area) { return area.id * 0.0625; }).includes(pos); });\n        }\n        this.props.onChange(this.notes);\n        this.redraw();\n    };\n    SingleNoteLane.prototype.addHighlight = function (area) {\n        this.highlights.add(area);\n        this.redraw(true);\n    };\n    SingleNoteLane.prototype.removeHighlight = function (area) {\n        this.highlights[\"delete\"](area);\n        this.redraw(true);\n    };\n    SingleNoteLane.prototype.removeAllHighlights = function () {\n        this.highlights.clear();\n        this.redraw(true);\n    };\n    SingleNoteLane.defaultProps = {\n        style: __assign(__assign({}, LazyCanvasRedrawer_1.lazyCanvasRedrawerDefaultProps.style), { color: 'red' }),\n        width: 750,\n        height: 50,\n        onChange: function () { }\n    };\n    return SingleNoteLane;\n}(LazyCanvasRedrawer_1.LazyCanvasRedrawer));\nexports.SingleNoteLane = SingleNoteLane;\n//# sourceMappingURL=SingleNoteLane.js.map","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nexports.__esModule = true;\nvar PianoKeyboard_1 = require(\"./components/PianoKeyboard/PianoKeyboard\");\nexports.PianoKeyboard = PianoKeyboard_1.PianoKeyboard;\nvar GuitarChordDiagram_1 = require(\"./components/GuitarChordDiagram/GuitarChordDiagram\");\nexports.GuitarChordDiagram = GuitarChordDiagram_1.GuitarChordDiagram;\n__export(require(\"./components/ButtonGrid\"));\n__export(require(\"./components/SingleNoteLane/SingleNoteLane\"));\n__export(require(\"./components/MultiNoteLanes/MultiNoteLanes\"));\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nexports.__esModule = true;\nvar React = require(\"react\");\nvar drawKeyboardInCanvas_1 = require(\"./drawKeyboardInCanvas\");\nvar LazyCanvasRedrawer_1 = require(\"../../generic-components/LazyCanvasRedrawer/LazyCanvasRedrawer\");\nvar base_1 = require(\"@musicenviro/base\");\nvar clickedPointInCanvas_1 = require(\"../../utils/clickedPointInCanvas\");\nvar defaultProps = __assign({ onNoteDown: function () { }, onNoteUp: function () { }, keyRange: {\n        min: 36,\n        max: 72\n    } }, LazyCanvasRedrawer_1.lazyCanvasRedrawerDefaultProps);\nvar PianoKeyboard = (function (_super) {\n    __extends(PianoKeyboard, _super);\n    function PianoKeyboard(props) {\n        var _this = _super.call(this, props) || this;\n        _this.keys = [];\n        _this.state = {\n            depressedKeys: []\n        };\n        return _this;\n    }\n    PianoKeyboard.prototype.draw = function (ctx) {\n        this.keys = drawKeyboardInCanvas_1.drawKeyboardInCanvas(ctx, this.props, Array.from(this.state.depressedKeys));\n    };\n    PianoKeyboard.prototype.handleClick = function (e) {\n        var _this = this;\n        var key = this.getKeyUnderPoint(clickedPointInCanvas_1.mousePointInElement(this.ref.current, e));\n        if (key) {\n            var prevDep = this.state.depressedKeys;\n            if (prevDep.includes(key.pitch)) {\n                this.setState({ depressedKeys: prevDep.filter(function (n) { return n !== key.pitch; }) }, function () {\n                    _this.props.onNoteUp(key.pitch);\n                });\n            }\n            else {\n                this.setState({ depressedKeys: __spread(prevDep, [key.pitch]) }, function () {\n                    _this.props.onNoteDown(key.pitch, 127);\n                });\n            }\n        }\n    };\n    PianoKeyboard.prototype.getKeyUnderPoint = function (point) {\n        var blackKeys = this.keys.filter(function (key) { return key.type === \"Black\"; });\n        var blackKeyUnderPoint = blackKeys.find(function (key) {\n            return base_1.pointInRect(point, key.rect);\n        });\n        if (blackKeyUnderPoint) {\n            return blackKeyUnderPoint;\n        }\n        else {\n            var whiteKeys = this.keys.filter(function (key) { return key.type === \"White\"; });\n            var whiteKeyUnderPoint = whiteKeys.find(function (key) {\n                return base_1.pointInRect(point, key.rect);\n            });\n            return whiteKeyUnderPoint || null;\n        }\n    };\n    PianoKeyboard.prototype.render = function () {\n        var _this = this;\n        return (React.createElement(\"canvas\", { height: \"200px\", ref: this.ref, className: \"keyboard\", style: { width: \"100%\", height: \"100%\" }, onClick: function (e) { return _this.handleClick(e); } }));\n    };\n    PianoKeyboard.defaultProps = defaultProps;\n    return PianoKeyboard;\n}(LazyCanvasRedrawer_1.LazyCanvasRedrawer));\nexports.PianoKeyboard = PianoKeyboard;\n//# sourceMappingURL=PianoKeyboard.js.map","\"use strict\";\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nexports.__esModule = true;\nvar blackKeyHeightRatio = 0.6;\nfunction drawKeyboardInCanvas(ctx, props, selectedKeys) {\n    var whiteKeys = getWhiteKeys(props, ctx.canvas.width, ctx.canvas.height);\n    var blackKeys = getBlackKeys(whiteKeys);\n    __spread(whiteKeys, blackKeys).forEach(function (key) { return drawKeyInCanvas(ctx, key, selectedKeys.includes(key.pitch)); });\n    return __spread(whiteKeys, blackKeys);\n}\nexports.drawKeyboardInCanvas = drawKeyboardInCanvas;\nfunction drawKeyInCanvas(ctx, key, isSelected) {\n    ctx.fillStyle = getFillStyle();\n    ctx.strokeStyle = \"black\";\n    ctx.fillRect(key.rect.left, key.rect.top, key.rect.right - key.rect.left, key.rect.bottom - key.rect.top);\n    ctx.strokeRect(key.rect.left, key.rect.top, key.rect.right - key.rect.left, key.rect.bottom - key.rect.top);\n    function getFillStyle() {\n        if (key.type === 'White') {\n            if (isSelected) {\n                return 'lightblue';\n            }\n            else {\n                return 'white';\n            }\n        }\n        else {\n            if (isSelected) {\n                return 'blue';\n            }\n            else {\n                return 'black';\n            }\n        }\n    }\n}\nfunction midiPitchIsWhite(note) {\n    return [0, 2, 4, 5, 7, 9, 11].includes(note % 12);\n}\nfunction getWhiteKeys(props, width, height) {\n    var whiteNotesInRange = [];\n    for (var k = props.keyRange.min; k <= props.keyRange.max; k++) {\n        if (midiPitchIsWhite(k))\n            whiteNotesInRange.push(k);\n    }\n    var keyWidth = width / whiteNotesInRange.length;\n    return whiteNotesInRange.map(function (pitch, i) {\n        return {\n            type: \"White\",\n            rect: {\n                left: i * keyWidth,\n                top: 0,\n                right: (i + 1) * keyWidth,\n                bottom: height\n            },\n            pitch: pitch\n        };\n    });\n}\nfunction getBlackKeys(whiteKeys) {\n    var whiteKeyWidth = whiteKeys[0].rect.right - whiteKeys[0].rect.left;\n    var blackKeyWidth = (whiteKeyWidth * 7) / 12;\n    return whiteKeys\n        .slice(0, -1)\n        .filter(function (whiteKey) { return [0, 2, 5, 7, 9].includes(whiteKey.pitch % 12); })\n        .map(function (whiteKey) {\n        var width = whiteKey.rect.right - whiteKey.rect.left;\n        var height = whiteKey.rect.bottom - whiteKey.rect.top;\n        var diatonicStep = [0, 2, 4, 5, 7, 9].indexOf(whiteKey.pitch % 12);\n        var left = whiteKey.rect.right +\n            width * [-0.35, -0.25, -0.25, -0.35, -0.3, -0.25][diatonicStep];\n        return {\n            type: \"Black\",\n            rect: {\n                left: left,\n                top: whiteKey.rect.top,\n                right: left + blackKeyWidth,\n                bottom: whiteKey.rect.top + height * blackKeyHeightRatio\n            },\n            pitch: whiteKey.pitch + 1\n        };\n    });\n}\n//# sourceMappingURL=drawKeyboardInCanvas.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nexports.__esModule = true;\nvar drawDiagramInCanvas_1 = require(\"./drawDiagramInCanvas\");\nvar LazyCanvasRedrawer_1 = require(\"../../generic-components/LazyCanvasRedrawer/LazyCanvasRedrawer\");\nvar base_1 = require(\"@musicenviro/base\");\nvar defaultProps = __assign(__assign({}, LazyCanvasRedrawer_1.lazyCanvasRedrawerDefaultProps), { baseNote: 41, numFrets: 5, fingeredNotes: [48, 52, 55, 59, 60].map(function (n) { return ({\n        pitch: n,\n        isTonic: base_1.pitchClass(n) === 0\n    }); }), color: \"black\" });\nvar GuitarChordDiagram = (function (_super) {\n    __extends(GuitarChordDiagram, _super);\n    function GuitarChordDiagram() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.name = 'guitar-chord-diagram';\n        return _this;\n    }\n    GuitarChordDiagram.prototype.draw = function (ctx) {\n        drawDiagramInCanvas_1.drawDiagramInCanvas(ctx, this.props);\n    };\n    GuitarChordDiagram.defaultProps = defaultProps;\n    return GuitarChordDiagram;\n}(LazyCanvasRedrawer_1.LazyCanvasRedrawer));\nexports.GuitarChordDiagram = GuitarChordDiagram;\n//# sourceMappingURL=GuitarChordDiagram.js.map","\"use strict\";\nexports.__esModule = true;\nvar _ = require(\"lodash\");\nvar getStringAndFret_1 = require(\"./getStringAndFret\");\nfunction drawDiagramInCanvas(ctx, props) {\n    drawGridInCanvas(ctx, props.numFrets, props.color);\n    return drawFingersInCanvas(ctx, props);\n}\nexports.drawDiagramInCanvas = drawDiagramInCanvas;\nfunction getFretLineYCoords(height, numFrets) {\n    var result = [];\n    var fretHeight = height / (numFrets + 1);\n    for (var i = 0; i < numFrets + 1; i++) {\n        result.push(fretHeight * (i + 0.5));\n    }\n    return result;\n}\nfunction getStringXCoords(width) {\n    var stringWidth = width / 6;\n    return [0, 1, 2, 3, 4, 5].map(function (i) { return (i + 0.5) * stringWidth; });\n}\nfunction drawGridInCanvas(ctx, numFrets, color) {\n    var xCoords = getStringXCoords(ctx.canvas.width);\n    var yCoords = getFretLineYCoords(ctx.canvas.height, numFrets);\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 3;\n    xCoords.forEach(function (x) {\n        ctx.moveTo(x, yCoords[0]);\n        ctx.lineTo(x, _.last(yCoords));\n    });\n    yCoords.forEach(function (y) {\n        ctx.moveTo(xCoords[0], y);\n        ctx.lineTo(_.last(xCoords), y);\n    });\n    ctx.stroke();\n}\nfunction drawFingersInCanvas(ctx, props) {\n    var xCoords = getStringXCoords(ctx.canvas.width);\n    var yCoords = getFretLineYCoords(ctx.canvas.height, props.numFrets);\n    var fretHeight = yCoords[1] - yCoords[0];\n    var stringWidth = xCoords[1] - xCoords[0];\n    var radius = Math.min(stringWidth, fretHeight) * 0.25;\n    return props.fingeredNotes.map(function (note) {\n        var fingering = getStringAndFret_1.getStringAndFret(note.pitch, props.baseNote);\n        if (fingering.alternates.length > 0) {\n            drawFinger(fingering.string, fingering.fret, 'Diamond');\n            fingering.alternates.forEach(function (f) { return drawFinger(f.string, f.fret, 'Diamond'); });\n        }\n        else {\n            drawFinger(fingering.string, fingering.fret, note.isTonic ? 'TonicCircle' : 'NonTonicCircle');\n        }\n        return null;\n    }).filter(Boolean);\n    function drawFinger(string, fret, type) {\n        var x = xCoords[string];\n        var y = yCoords[fret] + fretHeight / 2;\n        ctx.lineWidth = 3;\n        ctx.beginPath();\n        switch (type) {\n            case 'TonicCircle':\n            case 'NonTonicCircle':\n                ctx.arc(x, y, radius, 0, 2 * Math.PI);\n                ctx.fillStyle = type === 'TonicCircle' ? 'white' : props.color;\n                ctx.fill();\n                break;\n            case 'Diamond':\n                ctx.moveTo(x - radius, y);\n                ctx.lineTo(x, y + radius);\n                ctx.lineTo(x + radius, y);\n                ctx.lineTo(x, y - radius);\n                ctx.closePath();\n                ctx.fillStyle = 'white';\n                ctx.fill();\n                ctx.fillStyle = props.color;\n                ctx.globalAlpha = 0.5;\n                ctx.fill();\n                ctx.globalAlpha = 1;\n                break;\n        }\n        ctx.stroke();\n    }\n}\n//# sourceMappingURL=drawDiagramInCanvas.js.map","\"use strict\";\nexports.__esModule = true;\nfunction getStringAndFret(pitch, baseNote) {\n    var stringMinimums = [0, 5, 10, 15, 19, 24].map(function (i) { return baseNote + i; });\n    var string = stringMinimums.findIndex(function (min, i) { return pitch >= min &&\n        (!stringMinimums[i + 1] || pitch < stringMinimums[i + 1]); });\n    var fret = pitch - stringMinimums[string];\n    var alternates = string === 4 && fret === 0 ? [{ string: 3, fret: 4 }] : [];\n    return { string: string, fret: fret, alternates: alternates };\n}\nexports.getStringAndFret = getStringAndFret;\n//# sourceMappingURL=getStringAndFret.js.map","\"use strict\";\nexports.__esModule = true;\nvar ButtonGrid_1 = require(\"./ButtonGrid\");\nexports.ButtonGrid = ButtonGrid_1.ButtonGrid;\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nexports.__esModule = true;\nvar React = require(\"react\");\nvar _ = require(\"lodash\");\nvar ButtonGridButton_1 = require(\"./ButtonGridButton\");\nfunction ButtonGrid(props) {\n    function rowHTML(row) {\n        return (React.createElement(\"tr\", { key: row }, _.times(props.numColumns, function (col) {\n            return ButtonGridButton_1.ButtonGridButton(col, props, row, handleClick);\n        })));\n    }\n    function handleClick(e, row, col) {\n        props.onButtonDown(row, col);\n    }\n    return (React.createElement(\"table\", { className: \"button-grid\", style: __assign({}, props.style) },\n        React.createElement(\"tbody\", null, _.times(props.numRows, rowHTML))));\n}\nexports.ButtonGrid = ButtonGrid;\nButtonGrid.defaultProps = {\n    numRows: 4,\n    numColumns: 4,\n    onButtonDown: function (row, column) { },\n    style: { color: \"white\" },\n    clickColor: \"pink\"\n};\n//# sourceMappingURL=ButtonGrid.js.map","\"use strict\";\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nexports.__esModule = true;\nvar React = require(\"react\");\nfunction ButtonGridButton(col, gridProps, row, gridHandleClick) {\n    var _a = __read(React.useState(false), 2), clicked = _a[0], setClicked = _a[1];\n    return (React.createElement(\"td\", { className: \"button-grid-button\", key: col, style: {\n            backgroundColor: clicked ? gridProps.clickColor : gridProps.style.color,\n            borderRadius: \"5px\"\n        }, onMouseDown: function (e) {\n            setClicked(true);\n            gridHandleClick(e, row, col);\n        }, onMouseUp: function () { return setTimeout(function () { return setClicked(false); }, 100); } }));\n}\nexports.ButtonGridButton = ButtonGridButton;\n//# sourceMappingURL=ButtonGridButton.js.map","\"use strict\";\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nexports.__esModule = true;\nvar convert_1 = require(\"./convert\");\nfunction drawLine(ctx, start, end, color, width, dash) {\n    if (color === void 0) { color = \"black\"; }\n    if (width === void 0) { width = 1; }\n    if (dash === void 0) { dash = []; }\n    ctx.strokeStyle = color;\n    ctx.lineWidth = width;\n    ctx.setLineDash(dash);\n    ctx.moveTo(start.x, start.y);\n    ctx.lineTo(end.x, end.y);\n    ctx.stroke();\n}\nexports.drawLine = drawLine;\nfunction drawLineP(ctx, propOptions, start, end) {\n    var args = [];\n    for (var _i = 4; _i < arguments.length; _i++) {\n        args[_i - 4] = arguments[_i];\n    }\n    drawLine.apply(void 0, __spread([ctx,\n        convert_1.propToAbs(ctx, start, propOptions || undefined),\n        convert_1.propToAbs(ctx, end, propOptions || undefined)], args));\n}\nexports.drawLineP = drawLineP;\n//# sourceMappingURL=drawLine.js.map","\"use strict\";\nexports.__esModule = true;\nvar convert_1 = require(\"./convert\");\nfunction drawCircle(ctx, center, radius, color, filled, dash, alpha) {\n    if (color === void 0) { color = 'black'; }\n    if (filled === void 0) { filled = false; }\n    if (dash === void 0) { dash = []; }\n    if (alpha === void 0) { alpha = 1; }\n    ctx.save();\n    ctx.globalAlpha = alpha;\n    ctx.beginPath();\n    ctx.arc(center.x, center.y, radius, 0, 2 * Math.PI);\n    if (filled) {\n        ctx.fillStyle = color;\n        ctx.fill();\n    }\n    else {\n        ctx.setLineDash(dash);\n        ctx.strokeStyle = color;\n        ctx.stroke();\n    }\n    ctx.restore();\n}\nexports.drawCircle = drawCircle;\nfunction drawCircleP(ctx, propOptions, center, radius, color, filled, alpha) {\n    if (color === void 0) { color = 'black'; }\n    if (filled === void 0) { filled = false; }\n    if (alpha === void 0) { alpha = 1; }\n    var smallDim = Math.min(ctx.canvas.width, ctx.canvas.height);\n    drawCircle(ctx, convert_1.propToAbs(ctx, center, propOptions || undefined), propOptions.fixedRadius ? radius : radius * smallDim, color, filled, [], alpha);\n}\nexports.drawCircleP = drawCircleP;\n//# sourceMappingURL=drawCircle.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nexports.__esModule = true;\nexports.tree44 = {\n    nodes: __spread(Array(4)).map(function () { return ({\n        units: 1,\n        subtree: { nodes: __spread(Array(2)).map(function () { return ({ units: 1, subtree: { nodes: [1, 1] } }); }) }\n    }); })\n};\nfunction getRhythmPoints(tree, depth, start, totalDuration) {\n    if (depth === void 0) { depth = 0; }\n    if (start === void 0) { start = 0; }\n    if (totalDuration === void 0) { totalDuration = 1; }\n    var position = start;\n    var unitSize = totalDuration / numUnits(tree);\n    var result = [];\n    tree.nodes.forEach(function (node, i) {\n        if (typeof node === 'number') {\n            result.push({ position: position, depth: i === 0 ? depth : depth + 1 });\n            position += unitSize * node;\n        }\n        else {\n            var nextDepth = getRhythmPoints(node.subtree, depth + 1, position, unitSize * node.units);\n            var adjustedFirst = i === 0 ? __assign(__assign({}, nextDepth[0]), { depth: depth }) : nextDepth[0];\n            result.push.apply(result, __spread([adjustedFirst], nextDepth.slice(1)));\n            position += unitSize * node.units;\n        }\n    });\n    return result;\n}\nexports.getRhythmPoints = getRhythmPoints;\nfunction numUnits(tree) {\n    return tree.nodes.reduce(function (sum, node) { return sum + (typeof node === 'number' ? node : node.units); }, 0);\n}\n//# sourceMappingURL=trees.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar base_1 = require(\"@musicenviro/base\");\nvar events_1 = require(\"events\");\nvar clickedPointInCanvas_1 = require(\"../../utils/clickedPointInCanvas\");\nvar dragDebounceInterval = 100;\nvar counter = 0;\nvar MouseArea = (function () {\n    function MouseArea(rect, id) {\n        this.emitter = new events_1.EventEmitter();\n        this.rect = rect;\n        this.id = id;\n    }\n    MouseArea.prototype.emitMouseDown = function (p) {\n        this.emitter.emit('mousedown', p);\n    };\n    MouseArea.prototype.onMouseDown = function (callback) {\n        this.emitter.on('mousedown', callback);\n    };\n    MouseArea.prototype.emitMouseEnter = function () {\n        this.emitter.emit('mouseenter');\n    };\n    MouseArea.prototype.onMouseEnter = function (callback) {\n        this.emitter.on('mouseenter', callback);\n    };\n    MouseArea.prototype.emitMouseLeave = function () {\n        this.emitter.emit('mouseleave');\n    };\n    MouseArea.prototype.onMouseLeave = function (callback) {\n        this.emitter.on('mouseleave', callback);\n    };\n    return MouseArea;\n}());\nexports.MouseArea = MouseArea;\nvar CanvasMouseManager = (function (_super) {\n    __extends(CanvasMouseManager, _super);\n    function CanvasMouseManager() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.lastDragStamp = 0;\n        _this.areas = [];\n        _this.hover = new Set();\n        return _this;\n    }\n    CanvasMouseManager.prototype.initialize = function (canvas) {\n        var _this = this;\n        this.canvas = canvas;\n        canvas.onmousedown = function (event) { return _this.handleMouseDown(event); };\n        canvas.onmousemove = function (event) { return _this.handleMove(event); };\n        canvas.draggable = true;\n        canvas.ondragstart = function (event) { return _this.handleDragStart(event); };\n        canvas.ondrag = function (event) { return _this.handleDrag(event); };\n        canvas.onmouseleave = function (event) { return _this.handleMouseLeave(event); };\n        this.dragImage = document.createElement('img');\n        this.dragImage.setAttribute('style', 'width:' + 1 + 'px;height:' + 1 + 'px;border:none;display:block');\n        this.dragImage.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==';\n    };\n    CanvasMouseManager.prototype.getTopHover = function () {\n        return this.hover.values().next().value;\n    };\n    CanvasMouseManager.prototype.createArea = function (left, top, right, bottom, id) {\n        var area = new MouseArea({ left: left, top: top, right: right, bottom: bottom }, id);\n        this.areas.push(area);\n        return area;\n    };\n    CanvasMouseManager.prototype.getAreaUnderPoint = function (point) {\n        return this.areas.find(function (area) { return base_1.pointInRect(point, area.rect); });\n    };\n    CanvasMouseManager.prototype.getAllAreasUnderPoint = function (point) {\n        return new Set(this.areas.filter(function (area) { return base_1.pointInRect(point, area.rect); }));\n    };\n    CanvasMouseManager.prototype.handleMouseDown = function (event) {\n        var point = clickedPointInCanvas_1.mousePointInElement(this.canvas, event);\n        var area = this.getAreaUnderPoint(point);\n        if (area) {\n            area.emitMouseDown(base_1.subtractPoints(point, { x: area.rect.left, y: area.rect.top }));\n        }\n        this.emit('mousedown', event);\n    };\n    CanvasMouseManager.prototype.handleMove = function (event) {\n        var hovering = this.getAllAreasUnderPoint(clickedPointInCanvas_1.mousePointInElement(this.canvas, event));\n        var wasHovering = this.hover;\n        this.hover = hovering;\n        hovering.forEach(function (area) {\n            if (!wasHovering.has(area))\n                area.emitMouseEnter();\n        });\n        wasHovering.forEach(function (area) {\n            if (!hovering.has(area))\n                area.emitMouseLeave();\n        });\n        this.emit('mousemove', event);\n    };\n    CanvasMouseManager.prototype.handleMouseLeave = function (event) {\n        this.hover.forEach(function (area) { return area.emitMouseLeave(); });\n        this.hover.clear();\n    };\n    CanvasMouseManager.prototype.handleDragStart = function (event) {\n        this.dragStart = { x: event.clientX, y: event.clientY };\n        event.dataTransfer.setDragImage(this.dragImage, 1000, 1000);\n    };\n    CanvasMouseManager.prototype.handleMouseBoxDragEnd = function (ref) {\n    };\n    CanvasMouseManager.prototype.handleDrag = function (event) {\n        if (Date.now() - this.lastDragStamp > dragDebounceInterval) {\n            var movement = base_1.subtractPoints({ x: event.clientX, y: event.clientY }, this.dragStart);\n            this.lastDragStamp = Date.now();\n        }\n        else {\n        }\n    };\n    return CanvasMouseManager;\n}(events_1.EventEmitter));\nexports.CanvasMouseManager = CanvasMouseManager;\n//# sourceMappingURL=CanvasMouseManager.js.map","\"use strict\";\nexports.__esModule = true;\nvar events_1 = require(\"events\");\nexports.keysPressed = {};\nvar emitter = new events_1.EventEmitter();\nfunction onTransition(callback) {\n    emitter.on(\"transition\", callback);\n}\nexports.onTransition = onTransition;\nfunction emitTransition(key, newState) {\n    emitter.emit(\"transition\", key, newState);\n}\nwindow.addEventListener('keydown', function (ev) {\n    exports.keysPressed[ev.key] = true;\n    emitTransition(ev.key, 'Down');\n});\nwindow.addEventListener('keyup', function (ev) {\n    exports.keysPressed[ev.key] = false;\n    emitTransition(ev.key, 'Up');\n});\n//# sourceMappingURL=key-monitor.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nexports.__esModule = true;\nvar React = require(\"react\");\nvar SingleNoteLane_1 = require(\"../SingleNoteLane/SingleNoteLane\");\nfunction MultiNoteLanes(props) {\n    return (React.createElement(\"div\", null, ['blue', 'green', 'orange', 'red'].map(function (color, i) {\n        return (React.createElement(SingleNoteLane_1.SingleNoteLane, { key: i, style: __assign(__assign({}, SingleNoteLane_1.SingleNoteLane.defaultProps.style), { color: color }), onChange: function (notes) { return props.onChange && props.onChange(i, notes); } }));\n    })));\n}\nexports.MultiNoteLanes = MultiNoteLanes;\n//# sourceMappingURL=MultiNoteLanes.js.map","\nexport function kick(audioContext: AudioContext, start: number) {\n\n    var osc = audioContext.createOscillator();\n    var osc2 = audioContext.createOscillator();\n    var gainOsc = audioContext.createGain();\n    var gainOsc2 = audioContext.createGain();\n\n    osc.type = \"triangle\";\n    osc2.type = \"sine\";\n\n    gainOsc.gain.setValueAtTime(1, start);\n    gainOsc.gain.exponentialRampToValueAtTime(0.001, start + 0.5);\n    \n\n    gainOsc2.gain.setValueAtTime(1, start);\n    gainOsc2.gain.exponentialRampToValueAtTime(0.001, start + 0.5);\n  \n\n    osc.frequency.setValueAtTime(120, start);\n    osc.frequency.exponentialRampToValueAtTime(0.001, start + 0.5);\n\n    osc2.frequency.setValueAtTime(50, start);\n    osc2.frequency.exponentialRampToValueAtTime(0.001, start + 0.5);\n\n    osc.connect(gainOsc);\n    osc2.connect(gainOsc2);\n    gainOsc2.connect(audioContext.destination);\n    gainOsc.connect(audioContext.destination);\n    gainOsc.connect(audioContext.destination);\n    gainOsc2.connect(audioContext.destination);\n\n    osc.start(start);\n    osc2.start(start);\n\n    osc.stop(start + 0.5);\n    osc2.stop(start + 0.5);\n\n};\n\nexport function snare(audioContext: AudioContext, start: number) {\n\n    var osc3 = audioContext.createOscillator();\n    var gainOsc3 = audioContext.createGain();\n\n    var filterGain = audioContext.createGain();\n\n    filterGain.gain.setValueAtTime(1, start);\n    filterGain.gain.exponentialRampToValueAtTime(0.01, start + 0.2);\n\n    osc3.type = \"triangle\";\n    osc3.frequency.value = 100;\n    gainOsc3.gain.value = 0;\n\n    gainOsc3.gain.setValueAtTime(0, start);\n    gainOsc3.gain.exponentialRampToValueAtTime(0.01, start + 0.1);\n\n    osc3.connect(gainOsc3);\n    gainOsc3.connect(audioContext.destination);\n\n    osc3.start(start);\n    osc3.stop(start + 0.2);\n\n    var node = audioContext.createBufferSource(),\n        buffer = audioContext.createBuffer(1, 4096, audioContext.sampleRate),\n        data = buffer.getChannelData(0);\n\n    var filter = audioContext.createBiquadFilter();\n    filter.type = \"highpass\";\n    filter.frequency.setValueAtTime(100, start);\n    filter.frequency.linearRampToValueAtTime(1000, start + 0.2);\n\n\n    for (var i = 0; i < 4096; i++) {\n        data[i] = Math.random();\n    }\n    node.buffer = buffer;\n    node.loop = true;\n    node.connect(filter);\n    filter.connect(filterGain);\n    filterGain.connect(audioContext.destination);\n    node.start(start);\n    node.stop(start + 0.2);\n\n};\n\n\nexport function hihat(audioContext: AudioContext, start: number) {\n\n    var gainOsc4 = audioContext.createGain();\n    var fundamental = 40;\n    var ratios = [2, 3, 4.16, 5.43, 6.79, 8.21];\n\n    var bandpass = audioContext.createBiquadFilter();\n    bandpass.type = \"bandpass\";\n    bandpass.frequency.value = 10000;\n\n    var highpass = audioContext.createBiquadFilter();\n    highpass.type = \"highpass\";\n    highpass.frequency.value = 7000;\n\n\n    ratios.forEach(function(ratio) {\n\n        var osc4 = audioContext.createOscillator();\n        osc4.type = \"square\";\n        osc4.frequency.value = fundamental * ratio;\n        osc4.connect(bandpass);\n\n        osc4.start(start);\n        osc4.stop(start + 0.05);\n        \n    });\n\n    gainOsc4.gain.setValueAtTime(1, start);\n    gainOsc4.gain.exponentialRampToValueAtTime(0.01, start + 0.05);\n    \n    bandpass.connect(highpass);\n    highpass.connect(gainOsc4);\n    gainOsc4.connect(audioContext.destination);\n};","import { EventEmitter } from 'events';\nimport { getNewScheduledNotes } from './getNewScheduledNotes';\n\nconst lookahead = 0.1;\nconst timerInterval = 25;\n\nexport type Seconds = number;\nexport type PropTime = number; // proportional time (0 - 1)\n\nexport interface ILoopNote<T = number> {\n\tdata: T;\n\tloopTime: PropTime;\n}\n\nexport interface IScheduledNote<T = number> {\n\tdata: T;\n\taudioContextTime: Seconds;\n}\n\nexport class Scheduler<T> {\n\tac!: AudioContext;\n\ttimer!: NodeJS.Timer;\n\n\tloop: ILoopNote<T>[] = [];\n\tprevHorizon = 0; // how far we looked ahead on the last iteration\n\n\temitter = new EventEmitter();\n\tloopLength = 2; // seconds\n\n\tsetAudioContext(ac: AudioContext) {\n\t\tthis.ac = ac;\n\t}\n\n\tsetLoop(loop: ILoopNote<T>[]) {\n\t\tthis.loop = loop;\n\t}\n\n\tstart() {\n\t\tif (!this.timer) {\n\t\t\tthis.timer = setInterval(() => this.iterate(), timerInterval);\n\t\t}\n\t}\n\n\temitSchedule(notes: IScheduledNote<T>[]) {\n\t\tthis.emitter.emit('schedule', notes);\n\t}\n\n\tonSchedule(callback: (notes: IScheduledNote<T>[]) => void) {\n\t\tthis.emitter.on('schedule', callback);\n\t}\n\n\titerate() {\n        console.log(this.ac.currentTime)\n        \n\t\tconst {schedule, horizon} = getNewScheduledNotes(\n            this.loop,\n            this.ac.currentTime,\n            lookahead,\n\t\t\tthis.prevHorizon,\n\t\t\tthis.loopLength,\n            );\n            console.log(this.ac.currentTime)\n        \n        this.prevHorizon = horizon\n\n\t\tif (schedule.length > 0) {\n\t\t    console.log(schedule.map(note => note.audioContextTime))\n\t\t    this.emitSchedule(schedule)\n\t\t}\n\t}\n}\n","import { ILoopNote, Seconds, IScheduledNote } from './Scheduler';\nimport { IRange } from '@musicenviro/base';\nimport { windowPosition } from './windowPosition';\n\nexport function getNewScheduledNotes<T>(\n\tloop: ILoopNote<T>[],\n\tacTime: Seconds,\n\tlookAhead: Seconds,\n\tprevHorizon: Seconds,\n\tloopLength: Seconds,\n): {\n\tschedule: IScheduledNote<T>[];\n\thorizon: Seconds;\n} {\n\tconst win: IRange<Seconds> = {\n\t\tmin: Math.max(acTime, prevHorizon),\n\t\tmax: acTime + lookAhead,\n\t};\n\n\t// express range as number of loops\n\tconst rawPropWindow = { min: win.min / loopLength, max: win.max / loopLength };\n\n\t// translate range so that min falls between 0 and 1\n\tconst translation = (rawPropWindow.min % 1) - rawPropWindow.min;\n\tconst propWindow = {\n\t\tmin: rawPropWindow.min + translation,\n\t\tmax: rawPropWindow.max + translation,\n\t};\n\n\tconst schedule = loop\n\t\t.map((note) => {\n\t\t\tconst pos = windowPosition(note.loopTime, propWindow);\n\t\t\tif (!pos) return null;\n\t\t\treturn {\n\t\t\t\tdata: note.data,\n\t\t\t\taudioContextTime: (pos - translation) * loopLength,\n\t\t\t};\n\t\t})\n\t\t.filter(Boolean) as IScheduledNote<T>[];\n\n\treturn {\n\t\tschedule,\n\t\thorizon: win.max,\n\t};\n}\n\n\n","import { PropTime } from './Scheduler';\nimport { IRange } from '@musicenviro/base';\n/**\n *\n * @param loopTime\n * @param propWindow window expressed as prop time. if it spans the threshold, max will be greater than 1,\n *                      but min is always 0-1\n * @param loopLength\n */\nexport function windowPosition(loopTime: PropTime, propWindow: IRange<PropTime>): PropTime | null {\n    const offset = (loopTime - propWindow.min + 1) % 1;\n    if (offset > propWindow.max - propWindow.min)\n        return null;\n    if (loopTime < propWindow.min) {\n        return loopTime + 1;\n    }\n    else {\n        return loopTime;\n    }\n}\n","import React from 'react';\nimport './App.css';\n\nimport { MultiNoteLanes } from '@musicenviro/ui-elements';\nimport { kick, snare, hihat } from './drumSynth';\nimport { Scheduler, ILoopNote } from './Scheduler/Scheduler';\n\nconst testLoop = [\n\t{ data: 1, loopTime: 0 },\n\t{ data: 1, loopTime: 0.5 },\n\t{ data: 1, loopTime: 0.875 },\n];\n\nclass App extends React.Component {\n\tscheduler = new Scheduler<number>();\n\tac! : AudioContext;\n\t\n\tsubLoops: ILoopNote<number>[][] = [[],[],[],[]]\n\n\tconstructor(props: {}) {\n\t\tsuper(props);\n\n\t\t// this.scheduler.setLoop(testLoop);\n\n\t\tthis.scheduler.onSchedule(notes => \n\t\t\tnotes.forEach(note => {\n\t\t\t\tconst fn = [hihat, hihat, snare, kick][note.data]\n\t\t\t\tfn(this.ac, note.audioContextTime)\n\t\t\t})\n\t\t)\n\t}\n\n\tstartAudio() {\n\t\tif (this.ac) {\n\t\t\tthis.ac.resume()\n\t\t} else {\n\n\t\t\tthis.ac = new AudioContext();\n\t\t\tthis.scheduler.setAudioContext(this.ac)\n\t\t\tthis.scheduler.start()\n\t\t}\n\t}\n\n\tstopAudio() {\n\t\tthis.ac && this.ac.suspend()\n\t}\n\n\thandleNoteChange(instr: number, notes: number[]) {\n\t\tthis.subLoops[instr] = notes.map(note => ({\n\t\t\tdata: instr,\n\t\t\tloopTime: note\n\t\t}))\n\n\t\t\tthis.scheduler.setLoop(([] as ILoopNote[]).concat(...this.subLoops))\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"App\">\n\t\t\t\t<header>sequence collab</header>\n\t\t\t\t<div id=\"main\">\n\t\t\t\t\t<MultiNoteLanes \n\t\t\t\t\t\tonChange={(instr, notes) => { this.handleNoteChange(instr, notes)}}\n\t\t\t\t\t/>\n\t\t\t\t\t<button onClick={() => this.startAudio()}>play</button>\n\t\t\t\t\t<button onClick={() => this.stopAudio()}>pause</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}